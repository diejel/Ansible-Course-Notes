Ansible-Installation
------------------------
Centos:
sudo yum install  epel-release
sudo yum install ansible
ansible --version


Debian:
echo "deb http://ppa.launchpad.net/ansible/ansible/ubuntu trusty main" | sudo tee -a /etc/apt/sources.list

sudo apt install -y dirmngr

sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 93C4A3FD7BB9C367

sudo apt update

sudo apt install -y ansible sshpass 

Configuration Hierarchy
-----------------------
Environmental Variable: ANSIBLE_CONFIG
ansible.cfg  in Working Directory
$HOME/.ansible.cfg
/etc/ansible/ansible.cfg


ansible --version -> Show config file

echo > ~/.ansible.cfg

Show current file contents
========================
> ansible-config view

Show all configuration
=======================
> ansible-config list

Show current settings
======================
> ansible-config dump

Show only non-default settings
=============================
> ansible-config dump --only-changed

Sample of configuratio file
===========================
[defaults]
inventory=inventory ; set inventory file in the same working directory

remote_user = tux

#Full comments

[privilege_escalation]
become = true; or set in play when needed
become_method = sudo

Ad-hoc commands
----------------
-m -> to reference the ansible module
-a -> to reference optional arguments to module
-i -> to reference a different inventory
-k -> to prompt for ssh password

* Basic Configuration
----------------------
From inventory hosts we will perform a simple script for
scan the publick ssh key cached  and add it to known_hosts file and
be accepted when we try to establish a secure communication

$ for h in 192.168.56.{2..4}; do ssh-keyscan $h >> ~/.ssh/known_hosts ; done

$ ssh-keygen (for generation)

*  Ping Hosts
---------------
This is not related to ICMP protocol, it is called like that but really
this is a module that look for a python interpreter active in the remote hosts
(-k , to prompt ssh password; -K to prompt for SUDO password)

$ ansible all -k -K -m ping 

* Distribute SSH Key
------------------
Distribution of the ssh key in all nodes where is created the same user tux
, add the ssh key in authorized_keys file
 
$ ansible all -k -m authorized_key \
-a " user='tux' state='present' \ 
key='{{ lookup{'file','/home/tux/.ssh/id_rsa.pub'} }}'  "

Copy Sudoers Files
---------------------
To allow passwordless for not being asked everytime for sudo rights

$ echo " tux ALL=(root) NOPASSWD:ALL" > tux
 

